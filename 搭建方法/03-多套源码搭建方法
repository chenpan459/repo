å¦‚æœä½ è¦é€šè¿‡ åŒä¸€å° Nginx HTTP æœåŠ¡å™¨ æ¥æä¾› å¤šå¥— Android æºç ï¼Œå¯ä»¥ä½¿ç”¨å¤šè·¯å¾„æˆ–å­åŸŸåæ¥è¿›è¡ŒåŒºåˆ†ã€‚
ä¸‹é¢æä¾›ä¸¤ç§é€šç”¨æ–¹å¼ï¼Œæ¨èä½¿ç”¨æ–¹å¼ä¸€ï¼Œç®€å•ç›´æ¥ã€‚


æ–¹å¼ä¸€ï¼šé€šè¿‡è·¯å¾„è¿›è¡ŒåŒºåˆ†ï¼ˆæ¨èï¼‰
ğŸ“ ç›®å½•ç»“æ„ç¤ºæ„ï¼š

å‡è®¾ä½ æœ‰ä¸‰å¥— Android æºç ï¼š

/opt/repo_share/
â”œâ”€â”€ android_11/
â”œâ”€â”€ android_12/
â””â”€â”€ android_13/

æ¯ä¸ªå­ç›®å½•é‡Œæ˜¯å®Œæ•´çš„ Android æºç åŠ .repo/manifests.git ä»“åº“ï¼š

/opt/repo_share/android_11/
    â””â”€â”€ .repo/manifests.git
    â””â”€â”€ platform/
    â””â”€â”€ device/
    â””â”€â”€ ...

/opt/repo_share/android_12/
...

ğŸŒ ä¿®æ”¹ Nginx é…ç½®ï¼š

server {
    listen 80;
    server_name _;

    location /android_11/ {
        alias /opt/repo_share/android_11/;
        autoindex on;
    }

    location /android_12/ {
        alias /opt/repo_share/android_12/;
        autoindex on;
    }

    location /android_13/ {
        alias /opt/repo_share/android_13/;
        autoindex on;
    }
}

é‡å¯ Nginxï¼š
sudo nginx -t
sudo systemctl restart nginx

ğŸ§ª å®¢æˆ·ç«¯ä½¿ç”¨æ—¶ç¤ºä¾‹ï¼š
# ä¸‹è½½ android_11
repo init -u http://<server-ip>/android_11/.repo/manifests.git
# ä¸‹è½½ android_12
repo init -u http://<server-ip>/android_12/.repo/manifests.git
# ä¸‹è½½ android_13
repo init -u http://<server-ip>/android_13/.repo/manifests.git







æ–¹å¼äºŒï¼šé€šè¿‡å­åŸŸååŒºåˆ†ï¼ˆéœ€ DNS é…ç½®ï¼‰
å¦‚æœä½ æœ‰å†…ç½‘ DNS æˆ–ä½¿ç”¨ hosts æ–‡ä»¶ï¼Œå¯ä»¥ï¼š

server {
    listen 80;
    server_name android11.local;
    location / {
        alias /opt/repo_share/android_11/;
        autoindex on;
    }
}

server {
    listen 80;
    server_name android12.local;
    location / {
        alias /opt/repo_share/android_12/;
        autoindex on;
    }
}

ç„¶åå®¢æˆ·ç«¯æ·»åŠ  /etc/hostsï¼š
192.168.1.100 android11.local
192.168.1.100 android12.local

å®¢æˆ·ç«¯è®¿é—®ï¼š
repo init -u http://android11.local/.repo/manifests.git

ğŸ“ æ³¨æ„äº‹é¡¹
    æ¯ä¸ªç›®å½•çš„ .repo/manifests.git ä¸€å®šæ˜¯ bare ä»“åº“
git clone --bare manifests manifests.git

å»ºè®®æ¯å¥—ä»£ç ä½¿ç”¨ä¸åŒè·¯å¾„ï¼Œå¦‚ï¼š
    /repo/android_11/
    /repo/android_12/

æ¯å¥— manifest çš„ default.xml ä¸­ fetch è·¯å¾„è¦æ­£ç¡®ï¼Œä¾‹å¦‚ï¼š
<remote name="origin" fetch="." />